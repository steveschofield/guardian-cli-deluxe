# Guardian Configuration File
# Default settings for AI-powered penetration testing

# AI Configuration
ai:
  # Supported providers: gemini, ollama, openrouter
  provider: ollama
  #model: "llama3.1:8b"
  model: "deepseek-r1:8b"
  base_url: "http://192.168.1.69:11434"
  # OpenRouter example:
  #provider: openrouter
  #model: "xiaomi/mimo-v2-flash:free"
  #base_url: "https://openrouter.ai/api/v1"
  #
  # Gemini (Vertex AI via ADC) example (recommended for higher limits):
  # - Install deps: pip install -U google-genai
  # - Authenticate: gcloud auth application-default login
  # - Configure project id OR project number below (NOT an API key):
  #provider: gemini
  #model: "gemini-2.5-flash"
  #vertexai: true
  #project: "<project # or put GOOGLE_CLOUD_PROJECT=1234 in .env>"
  #location: "us-central1"
  #temperature: 0.2
  max_tokens: 8000
  # Limit total characters sent to the LLM (across system prompt + context + current prompt).
  # Helps avoid provider context limits and reduces latency/cost.
  max_input_chars: 40000
  # Optional: desired context window size (only enforced for Ollama via num_ctx; other providers may ignore).
  # context_window: 8192
  # Max characters of tool output to include in LLM prompts (larger = more context, more tokens/cost)
  max_tool_output_chars: 20000
  timeout: 600

# Penetration Testing Settings
pentest:
  # Safety mode prevents automatic execution of risky commands
  safe_mode: true
  
  # Maximum number of tools to run in parallel
  max_parallel_tools: 3
  
  # Require user confirmation before executing any tool
  require_confirmation: true
  
  # Maximum scan depth for recursive operations
  max_depth: 3
  
  # Request timeout for tools (seconds)
  tool_timeout: 300

# Output Settings
output:
  # Default format: markdown, html, json
  format: markdown
  
  # Save path for reports and outputs
  save_path: ./reports
  
  # Include AI reasoning in reports
  include_reasoning: true
  
  # Verbosity level: quiet, normal, verbose, debug
  verbosity: normal

# Scope Validation
scope:
  # Blacklisted IP ranges (CIDR notation)
  blacklist:
    - 127.0.0.0/8
  
  # Require explicit scope file for scanning
  require_scope_file: false
  
  # Maximum number of targets per scan
  max_targets: 100

# Tool Configuration
tools:
  nmap:
    enabled: true
    default_args: "-sV -sC"
    timing: T4
    
  httpx:
    enabled: true
    threads: 50
    timeout: 10
    
  subfinder:
    enabled: true
    sources: ["crtsh", "hackertarget"]
    
  nuclei:
    enabled: true
    severity: ["critical", "high", "medium"]
    templates_paths:
      - ~/nuclei-templates
      - ~/nuclei-templates-extra/kenzer
      - ~/nuclei-templates-extra/geeknik
      - ~/nuclei-templates-extra/emadshanab
    tags: ["cve", "exposure", "rce", "default"]

  naabu:
    enabled: true
    rate: 1000
    top_ports: 100
    exclude_cdn: true

  katana:
    enabled: true
    depth: 2
    concurrency: 10

  asnmap:
    enabled: true
    include_org: true

  waybackurls:
    enabled: true

  zap:
    enabled: false
    # Run mode: "docker" recommended, or "local" for a locally-installed ZAP script.
    mode: docker
    docker_image: "owasp/zap2docker-stable"
    # baseline = passive (safer), full = active scan (requires pentest.safe_mode: false)
    scan: baseline
    # Time budget for the scan scripts (minutes)
    max_minutes: 10

# Workflow Settings
workflows:
  # Default workflow timeout (seconds)
  timeout: 3600
  
  # Save intermediate results
  save_intermediate: true
  
  # Resume from checkpoint on failure
  resume_on_failure: true

# Logging
logging:
  # Enable audit logging
  enabled: true
  
  # Log file path
  path: ./logs/guardian.log
  
  # Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
  level: INFO
  
  # Log AI decisions
  log_ai_decisions: true
