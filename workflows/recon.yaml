# Reconnaissance Workflow
# Comprehensive reconnaissance of a target domain

name: reconnaissance
description: Complete reconnaissance workflow including subdomain enumeration, port scanning, and technology detection

steps:
  - name: subdomain_discovery
    type: tool
    tool: subfinder
    objective: "Enumerate all subdomains of the target domain"
    parameters:
      all_sources: true

  - name: dns_enumeration
    type: tool
    tool: dnsx
    objective: "Perform DNS resolution and record enumeration for domain/IP hosts"
    parameters:
      recon: true

  - name: godeye_recon
    type: tool
    tool: godeye
    objective: "Comprehensive subdomain reconnaissance with AI analysis"
    parameters:
      enable_ai: true

  - name: port_scan_main_domain
    type: tool
    tool: nmap
    objective: "Scan main domain for open ports and services"
    parameters:
      ports: "top-1000"
      scan_type: "-sV"

  - name: nmap_vuln_scan
    type: tool
    tool: nmap
    objective: "Nmap NSE vulnerability scripts on discovered ports"
    parameters:
      profile: "vuln"
      ports_from_context: true
      tool_timeout: 900

  - name: nmap_vulners_scan
    type: tool
    tool: nmap
    objective: "Nmap vulners script scan on discovered ports"
    parameters:
      args: "-sV --script vulners"
      ports_from_context: true
      tool_timeout: 900

  - name: http_probing
    type: tool
    tool: httpx
    objective: "Probe all discovered domains for HTTP services"
    parameters:
      tech_detect: true

  - name: security_assessment
    type: tool
    tool: godeye
    objective: "Deep security assessment: subdomain takeover, exposed configs, secrets scanning"
    parameters:
      no_brute: true
      active_only: true
      enable_ai: false
    dependencies:
      - http_probing

  - name: web_vuln_scan_nikto
    type: tool
    tool: nikto
    objective: "Baseline web vulnerability scan of responsive hosts"
    parameters:
      format: "csv"
    dependencies:
      - http_probing
    
  - name: vulnerability_scan
    type: tool
    tool: nuclei
    objective: "Scan for common vulnerabilities"
    parameters:
      severity: ["critical", "high"]
  
  - name: analyze_results
    type: analysis
    agent: analyst
    objective: "Correlate findings from all tools"
    
  - name: generate_report
    type: report
    agent: reporter
    format: markdown

# Configuration
settings:
  max_parallel_tools: 2
  require_confirmation: true
  save_intermediate: true
